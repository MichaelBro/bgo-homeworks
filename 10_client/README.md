# Домашнее задание к занятию «3.3. HTTP: разработка клиента и интеграция со сторонними сервисами»

В качестве результата пришлите ссылки на ваши GitHub-проекты в личном кабинете студента на сайте [netology.ru](https://netology.ru).

Все задачи этого занятия нужно делать в **разных репозиториях**.

**Важно**: если у вас что-то не получилось, то оформляйте Issue [по установленным правилам](../report-requirements.md).

**ВАЖНО**: НИ В КОЕМ СЛУЧАЕ НЕ ПОДСТАВЛЯЙТЕ ДАННЫЕ СВОИХ РЕАЛЬНЫХ КАРТ В КОД! Это очень частая "оплошность", когда разработчики случайно коммитят и заливают на GitHub "чувствительные" (sensitive) данные (ключи, логины, пароли, адреса и т.д.). Используйте генераторы вроде: https://www.freeformatter.com/credit-card-number-generator-validator.html

Если вы всё же "случайно" залили чувствительные данные на GitHub, то используйте [инструкцию по удалению данных](https://help.github.com/en/github/authenticating-to-github/removing-sensitive-data-from-a-repository). Кроме того, как бы это печально не было, рекомендуем вам заблокировать карту и заказать в банке новую.

## Как сдавать задачи

1. Создайте на вашем компьютере Go-модуль (см. доп.видео к первой лекции)
1. Инициализируйте в нём пустой Git-репозиторий
1. Добавьте в него готовый файл [.gitignore](../.gitignore)
1. Добавьте в этот же каталог остальные необходимые файлы (убедитесь, что они аккуратно разложены по пакетам)
1. Удостоверьтесь, что вы правильно отформатировали файлы (см. раздел Форматирование из [первого ДЗ](../01_std))
1. Сделайте необходимые коммиты
1. Создайте публичный репозиторий на GitHub и свяжите свой локальный репозиторий с удалённым
1. Сделайте пуш (удостоверьтесь, что ваш код появился на GitHub)
1. Ссылку на ваш проект отправьте в личном кабинете на сайте [netology.ru](https://netology.ru)
1. Задачи, отмеченные, как необязательные, можно не сдавать, это не повлияет на получение зачета (в этом ДЗ все задачи являются обязательными)

## Задача №1 - QR Code

QR-коды по-прежнему достаточно широко используются в нашем окружении.

Например, тот же Банк Тинькофф выдаёт по QR-кода деньги из банкомата.

Конечно, мы можем изучить как генерируются подобные коды и даже сами что-то написать, но это будет очень долго. Почему бы не взять готовую реализацию (например, библиотеку), а ещё лучше - готовый веб-сервис. Пусть этот веб-сервис поддерживает кто-то другой, наша же задача - быть пользователями (это мы потихоньку переходим в сфере микросервисов).

Сервис http://goqr.me предоставляет API для генерации QR кодов. Конечно же, в промышленных решениях вы не будете использовать неизвестный вам сервис и, скорее всего, напишите свой. Но сейчас для нас - это самое то.

Всё, что нужно сделать - это отправить соответствующий HTTP-запрос на сервер. В ответ нам придёт изображение. А поскольку изображение (как вы уже знаете) - это просто набор байт, то мы можем сохранить этот набор байт в файл с нужным расширением (вспомните про `Content-Type` или почитайте документацию на сам сервис).

Вам нужно изучить документацию по адресу: http://goqr.me/api/doc/create-qr-code/ и написать сервис, который на вход принимает строку, которую нужно закодировать, и название файла, в который нужно записать получившийся QR-код.

Помимо всего прочего, в этой задаче нужно использовать `Context` с таймаутом (т.е. если удалённый сервер не ответил за нужное время, работа должна завершаться).

Таймаут должен определяться через переменную окружения и быть в миллисекундах.

Когда будете тестировать, выставляйте маленький таймаут (в несколько десятков миллисекунд), чтобы удостовериться, что он действительно срабатывает.

Запуск метода сервиса осуществляйте в `main`:
```go
// файл main.go
func main() {
    // TODO: получить данные из переменных окружения
    ctx, _ := context.WithTimeout(context.Background(), timeout)
    svc := qr.NewService()
    data, filetype, err := svc.Encode(ctx, data)
    // TODO: handle err & write data to file
}
```

Основная сложность - продумать, что должен возвращать метод `Encode`. Это вы можете увидеть по тому, что стоит слева от его вызова:
* `data` - сами данные (`[]byte`)
* `filetype` - тип файла (можете возвращать mime-type)
* `err` - ошибка

Итого, у вас должно быть: оформленный проект с пакетами, выложенный в репозиторий на GitHub (автотесты делать не нужно).
